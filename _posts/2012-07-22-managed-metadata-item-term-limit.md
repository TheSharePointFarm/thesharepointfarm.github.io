---
layout: post
title: Managed Metadata Item Term Limit
tags: [sp2010]
---

It looks like there is a limit to the number of Managed Metadata terms a particular item can have.  In my experimenting, it was 192.  The 193 would generate a SQL Server exception and limitation.  SQL Server has a [limit of 2,100 parameters per stored procedure and per user-defined function](http://msdn.microsoft.com/en-us/library/ms143432.aspx).  While walking through the code with 192 terms, the SharePoint List item was saved successfully.  When adding the 193rd item, the query fails:

![Capture5](/assets/images/2012/07/Capture5.png)

The managed metadata terms used on this item were:

```text
1; 10; 100; 101; 102; 103; 104; 105; 106; 107; 108; 109; 11; 110; 111; 112; 113; 114; 115; 116; 117; 118; 12; 13; 14; 15; 16; 17; 18; 19; 199; 2; 20; 200; 201; 202; 203; 204; 205; 206; 207; 208; 209; 21; 210; 211; 212; 213; 214; 215; 216; 217; 218; 219; 22; 220; 221; 222; 223; 224; 225; 226; 227; 228; 229; 23; 230; 231; 232; 233; 234; 235; 236; 237; 238; 239; 24; 240; 241; 242; 243; 244; 246; 247; 248; 25; 250; 251; 252; 253; 255; 256; 257; 258; 259; 26; 260; 261; 262; 263; 264; 265; 266; 267; 268; 269; 27; 270; 271; 272; 273; 274; 275; 276; 277; 278; 279; 28; 280; 281; 282; 283; 284; 285; 286; 289; 29; 290; 291; 292; 293; 294; 295; 297; 298; 299; 3; 30; 300; 31; 32; 33; 34; 36; 37; 38; 39; 4; 40; 41; 42; 43; 44; 45; 46; 47; 48; 49; 5; 50; 51; 52; 53; 54; 55; 56; 57; 58; 59; 6; 60; 61; 62; 63; 64; 65; 66; 67; 68; 69; 7; 70; 71; 72; 73; 74; 75; 76; 77; 78; 79; 8;
```

Adding another term to that list, in my case, “81”, would generate the above error upon saving the document.  SharePoint will report the following in the Application Event Log:

```text
Log Name: Application
Source: Microsoft-SharePoint Products-SharePoint Foundation
Date: 7/22/2012 10:34:23 AM
Event ID: 5586
Task Category: Database
Level: Error
Keywords:
User: NAUPLIUS\trevor
Computer: SHAREPOINT.nauplius.local
Description:
Unknown SQL Exception 8003 occurred. Additional error information from SQL Server is included below.

The incoming request has too many parameters. The server supports a maximum of 2100 parameters. Reduce the number of parameters and resend the request.
```

Additionally, the ULS log will report the same error under SharePoint Foundation –> Database at both High and Critical levels.  Unfortunately, there is nothing about this type of limitation on the [SharePoint Software Boundaries and Limits](http://technet.microsoft.com/en-us/library/cc262787.aspx) page.

To view the query generated by attempting to update the item with more than 2,100 parameters, take a look at the following [SQL script](http://sdrv.ms/Nqe8Pl).